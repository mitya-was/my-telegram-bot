/**
 * –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV
 */

const CONFIG_FIXED = {
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ ...
  SPREADSHEET_ID: '1-n7KjvKhLQQXsxdMlJCKOTYBUjxzKqPaYJDwJbfnv4',
  DRIVE_FOLDER_ID: '1Y3idhIPTMY3BVgbneUs3USt-FgRjj0L9',
  FORM_ID: '1L4_WKxW8FjHV7tGwXhJCLzBLLdCQiMUvP6LRQV7zN8k',
  
  TELEGRAM: {
    BOT_TOKEN: '7371932063:AAGmg5RMPTgJU8zl3wC-qW8X2p9gD0rXCH8',
    CHAT_ID: '-4586871556'
  },
  
  TEMPLATES: {
    CONTRACT: '1tU-sJ0GOW3q0A1a0Iq5VlVgPkH8p1vtcEAgELFOnjWs',
    ACT: '1example_act_template_id',
    INVOICE: '1example_invoice_template_id'
  },
  
  SHEETS: {
    CONTRACTS: 'Form Responses 1',
    PERFORMERS: '–í–∏–∫–æ–Ω–∞–≤—Ü—ñ'
  },
  
  // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ CSV
  FORM_FIELDS: {
    // –î–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –∫–æ–ª–æ–Ω–∫–∏ Q (–∏–Ω–¥–µ–∫—Å 16)
    TIMESTAMP: 1,               // B - Timestamp (06.08.2025 21:34:53)
    CLIENT_NAME: 16,            // Q - –º–æ–∫–∫–æ (—Ä–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏)
    CLIENT_TAX_TYPE: 17,        // R - –¢–û–í (—Ç–∏–ø –æ–ø–æ–¥–∞—Ç–∫—É–≤–∞–Ω–Ω—è)
    CLIENT_DIRECTOR: 18,        // S - –ü–µ—Ç—è (–¥–∏—Ä–µ–∫—Ç–æ—Ä)
    CLIENT_ADDRESS: 19,         // T - –æ–∏–º–ª–æ—É–∫ (–∞–¥—Ä–µ—Å–∞)
    CLIENT_EDRPOU: 20,          // U - 324234 (–Ñ–î–†–ü–û–£)
    CLIENT_BANK_ACCOUNT: 21,    // V - –≤–∞–∏–º—É–µ–∫ (–±–∞–Ω–∫—ñ–≤—Å—å–∫–∏–π —Ä–∞—Ö—É–Ω–æ–∫)
    CLIENT_BANK_NAME: 22,       // W - —É—Ü–∫–º5—É–∫ (–Ω–∞–∑–≤–∞ –±–∞–Ω–∫—É)
    CLIENT_BANK_MFO: 23,        // X - 23432 (–ú–§–û)
    DESCRIPTION: 24,            // Y - –µ–º—É—Ü–∫–∏ (–æ–ø–∏—Å –ø–æ—Å–ª—É–≥)
    PERIOD_START: 25,           // Z - –ø—É—Å—Ç–æ–µ (–ø–æ—á–∞—Ç–æ–∫ –ø–µ—Ä—ñ–æ–¥—É)
    PERIOD_END: 26,             // AA - –ø—É—Å—Ç–æ–µ (–∫—ñ–Ω–µ—Ü—å –ø–µ—Ä—ñ–æ–¥—É)
    AMOUNT: 27,                 // BB - 10.10.2025 (–ù–ï –°–£–ú–ê! –û–®–ò–ë–ö–ê –í –î–ê–ù–ù–´–•)
    CURRENCY: 28,               // CC - 11.11.2026 (–ù–ï –í–ê–õ–Æ–¢–ê! –û–®–ò–ë–ö–ê –í –î–ê–ù–ù–´–•)
    PAYMENT_TERM: 29,           // DD - 12444 (–ù–ï –¢–ï–†–ú–Ü–ù! –û–®–ò–ë–ö–ê –í –î–ê–ù–ù–´–•)
    PERFORMER_NAME: 30,         // EE - –≥—Ä–Ω (–ù–ï –í–ò–ö–û–ù–ê–í–ï–¶–¨! –û–®–ò–ë–ö–ê –í –î–ê–ù–ù–´–•)
    
    // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏:
    // CLIENT_NAME: "–º–æ–∫–∫–æ"
    // CLIENT_TAX_TYPE: "–¢–û–í" 
    // CLIENT_DIRECTOR: "–ü–µ—Ç—è"
    // CLIENT_ADDRESS: "–æ–∏–º–ª–æ—É–∫"
    // CLIENT_EDRPOU: "324234"
    // CLIENT_BANK_ACCOUNT: "–≤–∞–∏–º—É–µ–∫"
    // CLIENT_BANK_NAME: "—É—Ü–∫–º5—É–∫"
    // CLIENT_BANK_MFO: "23432"
    // DESCRIPTION: "–µ–º—É—Ü–∫–∏"
    // PERIOD_START: "" (–ø—É—Å—Ç–æ–µ)
    // PERIOD_END: "" (–ø—É—Å—Ç–æ–µ)
    // AMOUNT: "10.10.2025" (–û–®–ò–ë–ö–ê - —ç—Ç–æ –Ω–µ —Å—É–º–º–∞!)
    // CURRENCY: "11.11.2026" (–û–®–ò–ë–ö–ê - —ç—Ç–æ –Ω–µ –≤–∞–ª—é—Ç–∞!)
    // PAYMENT_TERM: "12444" (–≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å—É–º–º–∞?)
    // PERFORMER_NAME: "–≥—Ä–Ω" (–û–®–ò–ë–ö–ê - —ç—Ç–æ –Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å!)
  },
  
  CONTRACT_STATUS: {
    DRAFT: '–ß–µ—Ä–Ω–µ—Ç–∫–∞',
    ACTIVE: '–ê–∫—Ç–∏–≤–Ω–∏–π',
    COMPLETED: '–ó–∞–≤–µ—Ä—à–µ–Ω–∏–π',
    CANCELLED: '–°–∫–∞—Å–æ–≤–∞–Ω–∏–π'
  }
};

/**
 * –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–ê–†–°–ò–ù–ì–ê –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
 */
function parseFormDataFixed(e) {
  Logger.log('=== –ü–ê–†–°–ò–ù–ì –î–ê–ù–ò–• –§–û–†–ú–ò (–í–ò–ü–†–ê–í–õ–ï–ù–û) ===');
  
  if (!e || !e.values) {
    Logger.log('‚ùå –ù–µ–º–∞—î e.values');
    return {};
  }
  
  const values = e.values;
  Logger.log('–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–Ω–∞—á–µ–Ω—å:', values.length);
  Logger.log('–í—Å—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:', JSON.stringify(values));
  
  // –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV:
  // values[1] = "06.08.2025 21:34:53" (timestamp)
  // values[16] = "–º–æ–∫–∫–æ" (–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏)
  // values[17] = "–¢–û–í" (—Ç–∏–ø –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è)
  // values[18] = "–ü–µ—Ç—è" (–¥–∏—Ä–µ–∫—Ç–æ—Ä)
  // ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
  
  const result = {
    timestamp: values[1] || new Date(),
    clientName: values[16] || '',           // Q - –º–æ–∫–∫–æ
    clientTaxType: values[17] || '',        // R - –¢–û–í
    clientDirector: values[18] || '',       // S - –ü–µ—Ç—è
    clientAddress: values[19] || '',        // T - –æ–∏–º–ª–æ—É–∫
    clientEdrpou: values[20] || '',         // U - 324234
    clientBankAccount: values[21] || '',    // V - –≤–∞–∏–º—É–µ–∫
    clientBankName: values[22] || '',       // W - —É—Ü–∫–º5—É–∫
    clientBankMfo: values[23] || '',        // X - 23432
    description: values[24] || '',          // Y - –µ–º—É—Ü–∫–∏
    periodStart: values[25] || '',          // Z - –ø—É—Å—Ç–æ–µ
    periodEnd: values[26] || '',            // AA - –ø—É—Å—Ç–æ–µ
    amount: values[29] || '',               // DD - 12444 (–≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å—É–º–º–∞)
    currency: values[30] || '–≥—Ä–Ω',          // EE - –≥—Ä–Ω (–≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ –≤–∞–ª—é—Ç–∞)
    paymentTerm: values[31] || '',          // FF - –ø—É—Å—Ç–æ–µ
    performer: values[32] || ''             // GG - –ø—É—Å—Ç–æ–µ –∏–ª–∏ "Web Studio Pro"
  };
  
  Logger.log('–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥—É (–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ):', JSON.stringify(result));
  return result;
}

/**
 * –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
 */
function testFixedParsing() {
  // –°–∏–º—É–ª–∏—Ä—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV
  const mockEvent = {
    values: [
      '', // A - –ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä—É
      '06.08.2025 21:34:53', // B - Timestamp
      '', '', '', '', '', '', '', '', '', '', '', '', '', '', // C-P –ø—É—Å—Ç—ã–µ
      '–º–æ–∫–∫–æ', // Q - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
      '–¢–û–í', // R - –¢–∏–ø –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è
      '–ü–µ—Ç—è', // S - –î–∏—Ä–µ–∫—Ç–æ—Ä
      '–æ–∏–º–ª–æ—É–∫', // T - –ê–¥—Ä–µ—Å
      '324234', // U - –Ñ–î–†–ü–û–£
      '–≤–∞–∏–º—É–µ–∫', // V - –ë–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á–µ—Ç
      '—É—Ü–∫–º5—É–∫', // W - –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞
      '23432', // X - –ú–§–û
      '–µ–º—É—Ü–∫–∏', // Y - –û–ø–∏—Å–∞–Ω–∏–µ —É—Å–ª—É–≥
      '', // Z - –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞
      '', // AA - –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞
      '10.10.2025', // BB - (–æ—à–∏–±–æ—á–Ω–æ –≤ –ø–æ–ª–µ —Å—É–º–º—ã)
      '11.11.2026', // CC - (–æ—à–∏–±–æ—á–Ω–æ –≤ –ø–æ–ª–µ –≤–∞–ª—é—Ç—ã)
      '12444', // DD - –≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ —Å—É–º–º–∞
      '–≥—Ä–Ω', // EE - –≤–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ –≤–∞–ª—é—Ç–∞
      '10.02.2025', // FF - –≤–æ–∑–º–æ–∂–Ω–æ —Ç–µ—Ä–º–∏–Ω –æ–ø–ª–∞—Ç—ã
      'Web Studio Pro' // GG - –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
    ]
  };
  
  const result = parseFormDataFixed(mockEvent);
  
  Logger.log('=== –†–ï–ó–£–õ–¨–¢–ê–¢ –¢–ï–°–¢–£–í–ê–ù–ù–Ø ===');
  Logger.log('–ö–ª—ñ—î–Ω—Ç:', result.clientName); // –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "–º–æ–∫–∫–æ"
  Logger.log('–°—É–º–∞:', result.amount); // –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "12444"
  Logger.log('–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å:', result.performer); // –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Web Studio Pro"
  
  sendQuickTelegramMessage(`üß™ –¢–ï–°–¢ –í–ò–ü–†–ê–í–õ–ï–ù–û–ì–û –ü–ê–†–°–ò–ù–ì–£:\n\n–ö–ª—ñ—î–Ω—Ç: "${result.clientName}"\n–°—É–º–∞: "${result.amount}"\n–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: "${result.performer}"`);
  
  return result;
}